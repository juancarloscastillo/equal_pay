merit99$v7 <- car::recode(merit99$v7,"c(8,9)=NA",as.numeric = TRUE)
merit99$v8 <- car::recode(merit99$v8,"c(8,9)=NA",as.numeric = TRUE)
merit99$v4 <- sjmisc::rec(merit99$v4,rec="rev")
merit99$v5 <- sjmisc::rec(merit99$v5,rec="rev")
merit99$v6 <- sjmisc::rec(merit99$v6,rec="rev")
merit99$v7 <- sjmisc::rec(merit99$v7,rec="rev")
merit99$v8 <- sjmisc::rec(merit99$v8,rec="rev")
merit99 <- rename(merit99,
wfami = v4,
knope = v5,
refor = v6,
rinte = v7,
corru = v8)
poly99a <- psych::polychoric(select(merit99,c(wfami,knope,refor,rinte,corru)),na.rm = TRUE)
corrplot::corrplot.mixed(poly99a$rho,order = "AOE")
library(GPArotation)
sjPlot::sjt.fa(select(merit99,c(wfami,knope,refor,rinte)),
method = "wls",
nmbr.fctr = 2,
title="Analisis Factorial 1999 Percepcion")
m1per99 <- '
gah_nmerit=~wfami+knope+corru
recom=~refor+rinte
'
fit1 <- cfa(model = m1per99,data = merit99)
semPlot::semPaths(fit1, "std",
edge.color = "black",
style = "ram",
exoVar = TRUE,
intercepts = F,
thresholds = F,
fade =F)
merit99$v49 <- car::recode(merit99$v49,"c(8,9)=NA",as.numeric = TRUE)
merit99$v50 <- car::recode(merit99$v50,"c(8,9)=NA",as.numeric = TRUE)
merit99$v51 <- car::recode(merit99$v51,"c(8,9)=NA",as.numeric = TRUE)
merit99$v52 <- car::recode(merit99$v52,"c(8,9)=NA",as.numeric = TRUE)
merit99$v53 <- car::recode(merit99$v53,"c(8,9)=NA",as.numeric = TRUE)
merit99$v54 <- car::recode(merit99$v54,"c(8,9)=NA",as.numeric = TRUE)
merit99$v55 <- car::recode(merit99$v55,"c(8,9)=NA",as.numeric = TRUE)
merit99$v49 <-sjmisc::rec(merit99$v49,rec="rev")
merit99$v50 <-sjmisc::rec(merit99$v50,rec="rev")
merit99$v51 <-sjmisc::rec(merit99$v51,rec="rev")
merit99$v52 <-sjmisc::rec(merit99$v52,rec="rev")
merit99$v53 <-sjmisc::rec(merit99$v53,rec="rev")
merit99$v54 <-sjmisc::rec(merit99$v54,rec="rev")
merit99$v55 <-sjmisc::rec(merit99$v55,rec="rev")
merit99 <- rename(merit99,
respo=v49,
neduc=v50,
suprv=v51,
mafam=v52,
hchil=v53,
gdwrk=v54,
effor=v55)
poly99b<- psych::polychoric(select(merit99,c(respo,neduc,suprv,mafam,hchil,gdwrk,effor)),na.rm = TRUE)
corrplot::corrplot.mixed(poly99b$rho,order = "AOE")
library(GPArotation)
sjPlot::sjt.fa(select(merit99,c(respo,neduc,suprv,mafam,hchil,gdwrk,effor)),
method = "wls",
nmbr.fctr = 3,
title="Analisis Factorial 1999 Preferencia")
m1pref99 <- '
resp=~respo+neduc+suprv
fami=~mafam+hchil
merit=~gdwrk+effor
'
fit2 <- cfa(model = m1pref99,data = merit99, ordered = c("respo","neduc","suprv","mafam","hchil","gdwrk","effor"))
merit09 <- cl09 %>% select(v6:v16,v47:v52)
merit09$v6  <- car::recode(merit09$v6 ,"c(8,9)=NA",as.numeric = TRUE) # Recodificación missing
merit09$v7  <- car::recode(merit09$v7 ,"c(8,9)=NA",as.numeric = TRUE)
merit09$v8  <- car::recode(merit09$v8 ,"c(8,9)=NA",as.numeric = TRUE)
merit09$v10 <- car::recode(merit09$v10,"c(8,9)=NA",as.numeric = TRUE)
merit09$v12 <- car::recode(merit09$v12,"c(8,9)=NA",as.numeric = TRUE)
merit09$v13 <- car::recode(merit09$v13,"c(8,9)=NA",as.numeric = TRUE)
merit09$v14 <- car::recode(merit09$v14,"c(8,9)=NA",as.numeric = TRUE)
merit09$v16 <- car::recode(merit09$v16,"c(8,9)=NA",as.numeric = TRUE)
merit09$v6  <-sjmisc::rec(merit09$v6 ,rec="rev")# invertir sentido escala
merit09$v7  <-sjmisc::rec(merit09$v7 ,rec="rev")# invertir sentido escala
merit09$v8  <-sjmisc::rec(merit09$v8 ,rec="rev")# invertir sentido escala
merit09$v10 <-sjmisc::rec(merit09$v10,rec="rev")# invertir sentido escala
merit09$v12 <-sjmisc::rec(merit09$v12,rec="rev")# invertir sentido escala
merit09$v13 <-sjmisc::rec(merit09$v13,rec="rev")# invertir sentido escala
merit09$v14 <-sjmisc::rec(merit09$v14,rec="rev")# invertir sentido escala
merit09$v15 <-sjmisc::rec(merit09$v15,rec="rev")# invertir sentido escala
merit09$v16 <-sjmisc::rec(merit09$v16,rec="rev")# invertir sentido escala
merit09<- rename(merit09,
wfami=v6 ,
edpar=v7 ,
slfed=v8 ,
ambit=v9 ,
hwork=v10,
knope=v11,
polco=v12,
corru=v13,
etnic=v14,
relig=v15,
gendr=v16)
poly09a <- psych::polychoric(select(merit09,c(wfami,edpar,slfed,ambit,hwork,knope,polco,corru,etnic,relig,gendr)),na.rm = TRUE)
corrplot::corrplot.mixed(poly09a$rho,order = "AOE")
library(GPArotation)
sjPlot::sjt.fa(select(merit09,c(wfami,edpar,slfed,ambit,hwork,polco,corru,etnic,relig,gendr)),
method = "wls",
nmbr.fctr = 4,
title = "Analisis Factorial 2009 Percepcion")
merit09$v47  <- car::recode(merit09$v47,"c(8,9)=NA",as.numeric = TRUE) # Recodificación missing
merit09$v48  <- car::recode(merit09$v48,"c(8,9)=NA",as.numeric = TRUE)
merit09$v49  <- car::recode(merit09$v49,"c(8,9)=NA",as.numeric = TRUE)
merit09$v51  <- car::recode(merit09$v51,"c(8,9)=NA",as.numeric = TRUE)
merit09$v48  <-sjmisc::rec(merit09$v48 ,rec="rev")# invertir sentido escala
merit09$v49  <-sjmisc::rec(merit09$v49 ,rec="rev")# invertir sentido escala
merit09$v51  <-sjmisc::rec(merit09$v51 ,rec="rev")# invertir sentido escala
merit09$v52  <-sjmisc::rec(merit09$v52 ,rec="rev")# invertir sentido escala
merit09<- rename(merit09,
respo=v47,
neduc=v48,
mafam=v49,
hchil=v50,
gdwrk=v51,
effor=v52)
poly09b <- psych::polychoric(select(merit09,c(respo,neduc,mafam,hchil,gdwrk,effor)),na.rm = TRUE)
corrplot::corrplot.mixed(poly09b$rho,order = "AOE")
library(GPArotation)
sjPlot::sjt.fa(select(merit09,c(respo,neduc,mafam,hchil,gdwrk,effor)),
method = "wls",
nmbr.fctr = 2,
title = "Analisis Factorial 2009 Preferencia")
View(cl99)
load(file = "data/dataproc/cl09.RData")
load(file = "data/dataproc/cl99.RData")
load(file = "data/dataproc/cl19.RData")
salarios99 <- cl99 %>% select(v3,
v21,v16,    # Salario percibio obrero y gerente
v31,v26)# Salario justo    obrero y gerente
env()
environment()
for (i in bases) {
df.tmp <- get(i)
names(df.tmp) <- tolower(names(df.tmp))
assign(i, df.tmp)
save(df.tmp,file = (paste("data/dataproc/", i,".RData", sep="")))
}
rm(i)
for (i in bases) {
df.tmp <- get(i)
names(df.tmp) <- tolower(names(df.tmp))
assign(i, df.tmp)
save(df.tmp,file = (paste("data/dataproc/", i,".RData", sep="")))
}
load(file = "data/dataproc/cl09.RData")
rm(cl09)
load(file = "data/dataproc/cl09.RData")
for (i in bases) {
df.tmp <- get(i)
names(df.tmp) <- tolower(names(df.tmp))
save(df.tmp,file = (paste("data/dataproc/", i,".RData", sep="")))
assign(i, df.tmp)
}
for (i in bases) {
df.tmp <- get(i)
names(df.tmp) <- tolower(names(df.tmp))
assign(i, df.tmp)
save(df.tmp,file = (paste("data/dataproc/", i,".RData", sep="")))
}
cl09 <- issp09 %>% dplyr::filter(V4==152)
for (i in bases) {
df.tmp <- get(i)
names(df.tmp) <- tolower(names(df.tmp))
assign(i, df.tmp)
save(df.tmp,file = (paste("data/dataproc/", i,".RData", sep="")))
}
load(file = "data/dataproc/cl09.RData")
rm(cl09)
load(file = "data/dataproc/cl09.RData")
df.tmp <- get(i)
for (i in bases) {
df.tmp <- get(i)
names(df.tmp) <- tolower(names(df.tmp))
assign(i, df.tmp)
save(df.tmp,file = (paste("data/dataproc/", i,".RData", sep="")))
}
cl09 <- issp09 %>% dplyr::filter(V4==152)
for (i in bases) {
df.tmp <- get(i)
names(df.tmp) <- tolower(names(df.tmp))
assign(i, df.tmp)
save(df.tmp,file = (paste("data/dataproc/", i,".RData", sep="")))
}
rm(cl09)
load(file = "data/dataproc/cl09.RData")
for (i in bases) {
names(get(i)) <- tolower(names(get(i)))
assign(i, get(i))
}
for (i in bases) {
df.tmp <- get(i)
names(df.tmp) <- tolower(names(df.tmp))
assign(i, df.tmp)
}
cl09 <- issp09 %>% dplyr::filter(V4==152)
for (i in bases) {
names(get(i)) <- tolower(names(get(i)))
assign(i, get(i))
}
for (i in bases) {
df.tmp <- get(i)
names(df.tmp) <- tolower(names(df.tmp))
assign(i, df.tmp)
}
for (i in bases) {
save([[i]],file = (paste("data/dataproc/", i,".RData", sep="")))
for (i in bases) {
save([i],file = (paste("data/dataproc/", i,".RData", sep="")))
for (i in bases) {
save(i,file = (paste("data/dataproc/", i,".RData", sep="")))
}
for (i in bases) {
save(list=paste(i, sep=""), file = (paste("data/dataproc/", i,".RData", sep="")))
}
rm(cl09)
load(file = "data/dataproc/cl09.RData")
for (i in bases) {
df.tmp <- get(i)
names(df.tmp) <- tolower(names(df.tmp))
assign(i, df.tmp)
save(list=paste(i, sep=""), file = (paste("data/dataproc/", i,".RData", sep="")))
}
library(dplyr)
library(sjlabelled)
library(sjlabelled)
library(sjPlot)
library(sjlabelled)
library(sjPlot)
library(ggplot2)
library(knitr)
library(kableExtra)
library(GPArotation)
library(lavaan)
library(ggplot2)
library(knitr)
library(kableExtra)
library(GPArotation)
library(lavaan)
library(Cairo);options(shiny.usecairo=TRUE) # Para la calidad de los plots
load(file = "data/dataproc/cl09.RData")
load(file = "data/dataproc/cl99.RData")
load(file = "data/dataproc/cl19.RData")
salarios99 <- cl99 %>% select(v3,
v21,v16,    # Salario percibio obrero y gerente
v31,v26)# Salario justo    obrero y gerente
dim(salarios99)
summary(salarios99)
names(salarios99)
salarios99[2:4][salarios99[2:4] >= 99999999998] <- NA
salarios99$v3 <- as_character(salarios99$v3)
summary(salarios99)
dim(na.omit(salarios99))
colSums(is.na(salarios99))
salarios99 <- rename(salarios99,pais=v3,salperger=v16,salperobr=v21,saljusger=v26,saljusobr=v31)
dim(na.omit(salarios99))
salarios99 <- salarios99 %>%
mutate(salperobr=replace(salperobr, salperobr <= 40000 | salperobr>= 1000000, NA)) %>%
mutate(salperger=replace(salperger, salperger <= 250000 | salperger>= 100000001, NA)) %>%
mutate(saljusobr=replace(saljusobr, saljusobr <= 40000, NA)) %>%
mutate(saljusger=replace(saljusger, saljusger <= 100000, NA))
dim(na.omit(salarios99))
#---Brecha salarial percibida
salarios99$gap_perc   <-  as.numeric(salarios99$salperger/salarios99$salperobr) # diferencia total
salarios99$lngap_perc <-  as.numeric(log(salarios99$gap_perc))                 # diferencia log
#---Brecha salarial justa
salarios99$gap_just   <-  as.numeric(salarios99$saljusger/salarios99$saljusobr) # diferencia total
salarios99$lngap_just <-  as.numeric(log(salarios99$gap_just))                # diferencia log
salarios09 <- cl09 %>% select(v5,
v23,v25, # Salario percibido obrero y gerente
v28,v30) # Salario justo    obrero y gerente
summary(salarios09)
salarios09$v5 <- as_character(salarios09$v5)
#--- Nombres sustantivos para analisis
salarios09 <- rename(salarios09,pais=v5,salperger=v23,salperobr=v25,saljusger=v28,saljusobr=v30)
salarios09 <- salarios09 %>%
mutate(salperobr=replace(salperobr, salperobr <= 40000 | salperobr>= 1000000, NA)) %>%
mutate(salperger=replace(salperger, salperger <= 250000 | salperger>= 100000001, NA)) %>%
mutate(saljusobr=replace(saljusobr, saljusobr <= 40000, NA)) %>%
mutate(saljusger=replace(saljusger, saljusger <= 100000, NA))
summary(salarios09)
dim(na.omit(salarios09))
#---Brecha salarial percibida
salarios09$gap_perc   <-  as.numeric(salarios09$salperger/salarios09$salperobr) # diferencia total
salarios09$lngap_perc <-  as.numeric(log(salarios09$gap_perc))                # diferencia log
#---Brecha salarial justa
salarios09$gap_just   <-  as.numeric(salarios09$saljusger/salarios09$saljusobr) # diferencia total
salarios09$lngap_just <-  as.numeric(log(salarios09$gap_just))                # diferencia log
#---Brecha salarial percibida
salarios09$gap_perc   <-  as.numeric(salarios09$salperger/salarios09$salperobr) # diferencia total
salarios09$lngap_perc <-  as.numeric(log(salarios09$gap_perc))                # diferencia log
#---Brecha salarial justa
salarios09$gap_just   <-  as.numeric(salarios09$saljusger/salarios09$saljusobr) # diferencia total
salarios09$lngap_just <-  as.numeric(log(salarios09$gap_just))                # diferencia log
salarios19 <- cl19 %>% select(m2_p2_presidente,m2_p2_obrero,  # Salario percibio obrero y gerente
m2_p3_presidente,m2_p3_obrero) # Salario justo    obrero y gerente
summary(salarios19)
# NAs already identified
#--- Nombres sustantivos para analisis
salarios19 <- rename(salarios19,salperger=m2_p2_presidente,salperobr=m2_p2_obrero,
saljusger=m2_p3_presidente,saljusobr=m2_p3_obrero)
salarios19 <- salarios19 %>%
mutate(salperobr=replace(salperobr, salperobr <= 40000 | salperobr>= 1000000, NA)) %>%
mutate(salperger=replace(salperger, salperger <= 250000 | salperger>= 100000001, NA)) %>%
mutate(saljusobr=replace(saljusobr, saljusobr <= 40000, NA)) %>%
mutate(saljusger=replace(saljusger, saljusger <= 100000, NA))
summary(salarios19)
#---Brecha salarial percibida
salarios19$gap_perc   <-  as.numeric(salarios19$salperger/salarios19$salperobr) # diferencia total
salarios19$lngap_perc <-  as.numeric(log(salarios19$gap_perc))                  # diferencia log
#---Brecha salarial justa
salarios19$gap_just   <-  as.numeric(salarios19$saljusger/salarios19$saljusobr) # diferencia total
salarios19$lngap_just <-  as.numeric(log(salarios19$gap_just))                # diferencia log
table_perob<- rbind(psych::describe(salarios99$salperobr),
psych::describe(salarios09$salperobr),
psych::describe(salarios19$salperobr))
rownames(table_perob) <- c("1999","2009","2019")
table_perob <- table_perob %>% select(year,n,mean,sd,median,trimmed,min,max)
#--- Nombres sustantivos para analisis
salarios09 <- rename(salarios09,pais=v5,salperger=v23,salperobr=v25,saljusger=v28,saljusobr=v30)
salarios09 <- cl09 %>% select(v5,
v23,v25, # Salario percibido obrero y gerente
v28,v30) # Salario justo    obrero y gerente
summary(salarios09)
salarios09$v5 <- as_character(salarios09$v5)
#--- Nombres sustantivos para analisis
salarios09 <- rename(salarios09,pais=v5,salperger=v23,salperobr=v25,saljusger=v28,saljusobr=v30)
#--- Nombres sustantivos para analisis
salarios09 <- rename(salarios09,pais=v5,salperger=v23,salperobr=v25,saljusger=v28,saljusobr=v30)
salarios99 <- rename(salarios99,pais=v3,salperger=v16,salperobr=v21,saljusger=v26,saljusobr=v31)
load(file = "data/dataproc/cl09.RData")
load(file = "data/dataproc/cl99.RData")
load(file = "data/dataproc/cl19.RData")
salarios99 <- cl99 %>% select(v3,
v21,v16,    # Salario percibio obrero y gerente
v31,v26)# Salario justo    obrero y gerente
dim(salarios99)
summary(salarios99)
names(salarios99)
salarios99[2:4][salarios99[2:4] >= 99999999998] <- NA
salarios99$v3 <- as_character(salarios99$v3)
summary(salarios99)
dim(na.omit(salarios99))
colSums(is.na(salarios99))
salarios99 <- rename(salarios99,pais=v3,salperger=v16,salperobr=v21,saljusger=v26,saljusobr=v31)
#--- Nombres sustantivos para analisis
salarios09 <- rename(salarios09,pais=v5,salperger=v23,salperobr=v25,saljusger=v28,saljusobr=v30)
salarios09 <- cl09 %>% select(v5,
v23,v25, # Salario percibido obrero y gerente
v28,v30) # Salario justo    obrero y gerente
summary(salarios09)
salarios09$v5 <- as_character(salarios09$v5)
#--- Nombres sustantivos para analisis
salarios09 <- rename(salarios09,pais=v5,salperger=v23,salperobr=v25,saljusger=v28,saljusobr=v30)
#--- Nombres sustantivos para analisis
salarios09 <- rename(salarios09,pais=v5,salperger=v23,salperobr=v25,saljusger=v28,saljusobr=v30)
{
library(dplyr)
library(sjlabelled)
library(sjPlot)
library(ggplot2)
library(knitr)
library(kableExtra)
library(GPArotation)
library(lavaan)
library(Cairo);options(shiny.usecairo=TRUE) # Para la calidad de los plots
}
load(file = "data/dataproc/cl09.RData")
load(file = "data/dataproc/cl99.RData")
load(file = "data/dataproc/cl19.RData")
salarios99 <- cl99 %>% select(v3,
v21,v16,    # Salario percibio obrero y gerente
v31,v26)# Salario justo    obrero y gerente
dim(salarios99)
summary(salarios99)
# M2_P2_PRESIDENTE cuanto gana GERENTE
# M2_P2_OBRERO cuanto gana OBRERO
# M2_P3_PRESIDENTE cuanto deberia ganar GERENTE
# M2_P3_OBRERO cuanto deberia ganar OBRERO
# table(salarios99$v21) #  99999999999
# table(salarios99$V16) #  99999999998 99999999999
# table(salarios99$V31) # 99999999998 99999999999
# table(salarios99$V26) # 99999999998 99999999999
names(salarios99)
salarios99[2:4][salarios99[2:4] >= 99999999998] <- NA
salarios99$v3 <- as_character(salarios99$v3)
summary(salarios99)
dim(na.omit(salarios99))
colSums(is.na(salarios99))
salarios99 <- cl99 %>% select(v3,
v21,v16,    # Salario percibio obrero y gerente
v31,v26)# Salario justo    obrero y gerente
dim(salarios99)
summary(salarios99)
# M2_P2_PRESIDENTE cuanto gana GERENTE
# M2_P2_OBRERO cuanto gana OBRERO
# M2_P3_PRESIDENTE cuanto deberia ganar GERENTE
# M2_P3_OBRERO cuanto deberia ganar OBRERO
# table(salarios99$v21) #  99999999999
# table(salarios99$V16) #  99999999998 99999999999
# table(salarios99$V31) # 99999999998 99999999999
# table(salarios99$V26) # 99999999998 99999999999
names(salarios99)
salarios99[2:4][salarios99[2:4] >= 99999999998] <- NA
salarios99$v3 <- as_character(salarios99$v3)
summary(salarios99)
dim(na.omit(salarios99))
colSums(is.na(salarios99))
salarios99 <- rename(salarios99,pais=v3,salperger=v16,salperobr=v21,saljusger=v26,saljusobr=v31)
table(salarios99$salperobr) # <22000000 120000000
salarios99 %>% filter(salperobr <= 40000| salperobr >= 1000000) # 13 casos
table(salarios99$salperger)
salarios99 %>% filter(salperger <= 250000 | salperger >= 100000001) # 12 casos
table(salarios99$saljusobr) # <30000000
salarios99 %>% filter(saljusobr <= 40000) # 1 caso
table(salarios99$saljusger)
salarios99 %>% filter(saljusger <= 100000) # 5 casos
# Quitar outliers *************************
dim(na.omit(salarios99))
salarios99 <- salarios99 %>%
mutate(salperobr=replace(salperobr, salperobr <= 40000 | salperobr>= 1000000, NA)) %>%
mutate(salperger=replace(salperger, salperger <= 250000 | salperger>= 100000001, NA)) %>%
mutate(saljusobr=replace(saljusobr, saljusobr <= 40000, NA)) %>%
mutate(saljusger=replace(saljusger, saljusger <= 100000, NA))
#---Brecha salarial percibida
salarios99$gap_perc   <-  as.numeric(salarios99$salperger/salarios99$salperobr) # diferencia total
salarios99$lngap_perc <-  as.numeric(log(salarios99$gap_perc))                 # diferencia log
#---Brecha salarial justa
salarios99$gap_just   <-  as.numeric(salarios99$saljusger/salarios99$saljusobr) # diferencia total
salarios99$lngap_just <-  as.numeric(log(salarios99$gap_just))                # diferencia log
# table(salarios09$V23) # cuanto gana GERENTE
# table(salarios09$V25) # cuanto gana OBRERO
# table(salarios09$V28) # cuando deberia ganar GERENTE
# table(salarios09$V30) # cuanto deberia ganar OBRERO
salarios09 <- cl09 %>% select(v5,
v23,v25, # Salario percibido obrero y gerente
v28,v30) # Salario justo    obrero y gerente
summary(salarios09)
salarios09$v5 <- as_character(salarios09$v5)
#--- Nombres sustantivos para analisis
salarios09 <- rename(salarios09,pais=v5,salperger=v23,salperobr=v25,saljusger=v28,saljusobr=v30)
salarios09 <- salarios09 %>%
mutate(salperobr=replace(salperobr, salperobr <= 40000 | salperobr>= 1000000, NA)) %>%
mutate(salperger=replace(salperger, salperger <= 250000 | salperger>= 100000001, NA)) %>%
mutate(saljusobr=replace(saljusobr, saljusobr <= 40000, NA)) %>%
mutate(saljusger=replace(saljusger, saljusger <= 100000, NA))
summary(salarios09)
dim(na.omit(salarios09))
#---Brecha salarial percibida
salarios09$gap_perc   <-  as.numeric(salarios09$salperger/salarios09$salperobr) # diferencia total
salarios09$lngap_perc <-  as.numeric(log(salarios09$gap_perc))                # diferencia log
#---Brecha salarial justa
salarios09$gap_just   <-  as.numeric(salarios09$saljusger/salarios09$saljusobr) # diferencia total
salarios09$lngap_just <-  as.numeric(log(salarios09$gap_just))                # diferencia log
salarios19 <- cl19 %>% select(m2_p2_presidente,m2_p2_obrero,  # Salario percibio obrero y gerente
m2_p3_presidente,m2_p3_obrero) # Salario justo    obrero y gerente
summary(salarios19)
# NAs already identified
#--- Nombres sustantivos para analisis
salarios19 <- rename(salarios19,salperger=m2_p2_presidente,salperobr=m2_p2_obrero,
saljusger=m2_p3_presidente,saljusobr=m2_p3_obrero)
salarios19 <- salarios19 %>%
mutate(salperobr=replace(salperobr, salperobr <= 40000 | salperobr>= 1000000, NA)) %>%
mutate(salperger=replace(salperger, salperger <= 250000 | salperger>= 100000001, NA)) %>%
mutate(saljusobr=replace(saljusobr, saljusobr <= 40000, NA)) %>%
mutate(saljusger=replace(saljusger, saljusger <= 100000, NA))
summary(salarios19)
#---Brecha salarial percibida
salarios19$gap_perc   <-  as.numeric(salarios19$salperger/salarios19$salperobr) # diferencia total
salarios19$lngap_perc <-  as.numeric(log(salarios19$gap_perc))                  # diferencia log
#---Brecha salarial justa
salarios19$gap_just   <-  as.numeric(salarios19$saljusger/salarios19$saljusobr) # diferencia total
salarios19$lngap_just <-  as.numeric(log(salarios19$gap_just))                # diferencia log
table_perob<- rbind(psych::describe(salarios99$salperobr),
psych::describe(salarios09$salperobr),
psych::describe(salarios19$salperobr))
rownames(table_perob) <- c("1999","2009","2019")
table_perob <- table_perob %>% select(n,mean,sd,median,trimmed,min,max)
table_perob
table_perger<- rbind(psych::describe(salarios99$salperger),
psych::describe(salarios09$salperger),
psych::describe(salarios19$salperger))
rownames(table_perger) <- c("1999","2009","2019")
table_perger <- table_perger %>% select(n,mean,sd,median,trimmed,min,max)
table_perger
# Add occupation & year to tables
table_perob$ocup <- "Obrero"
table_perob$year <- c(1999,2009,2019)
table_perger$ocup <- "Gerente"
table_perger$year <- c(1999,2009,2019)
table_pertot <-rbind(table_perger,table_perob)
table_pertot
table_perob$ocup <- c("Obrero")
table_perob$year <- c(1999,2009,2019)
table_perger$ocup <- c("Gerente")
table_perger$year <- c(1999,2009,2019)
table_pertot <-rbind(table_perger,table_perob)
table_pertot
table_pertot <-rbind(table_perger,table_perob)
table_pertot
ggplot(table_pertot, aes(as.factor(year), median)) +
geom_bar(aes(fill = ocup), position = "dodge", stat="identity", width=.5)  +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), group="Ocup"), position=position_dodge(width=0.5), vjust=-0.5) +
theme_bw(base_size = 18) +
scale_y_continuous(labels = scales::comma) +
ylab('Salario (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") # quitar nombre leyenda, autoexplicativo
