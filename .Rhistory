table_pertot
bar <- ggplot(table_pertot, aes(as.factor(year),median)) +
geom_bar(aes(fill = factor(ocup, levels=c(1,2), labels=c("Obrero", "Gerente"))), position = "dodge", stat="identity", width=.5)  +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), group="Ocup"), position=position_dodge(width=0.5), vjust=-0.5) +
theme_bw(base_size = 18) +
scale_y_continuous(labels = scales::comma) +
ylab('Salario (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") # quitar nombre leyenda, autoexplicativo +
bar
# Horizontal
table_pertot$ocup2 <- factor(table_pertot$ocup, levels=c(2,1), labels=c("Gerente", "Obrero"))
ggplot(data=table_pertot, aes(x=reorder(as.factor(year),-median), y=median, fill=ocup2)) +
geom_bar(position = 'dodge', stat='identity') +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), y=0), position=position_dodge(0.9), hjust=-0.25) +
theme_bw(base_size = 12) +
scale_y_continuous(labels = scales::comma) +
ylab('Salario percibido (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") +
coord_flip()
# Tabla 1
table1<- rbind(psych::describe(salarios99$gap_perc),
psych::describe(salarios09$gap_perc),
psych::describe(salarios19$gap_perc))
rownames(table1) <- c("1999","2009","2019")
table1 <- table1 %>% select(n,mean,sd,median,trimmed,min,max)
kable(table1,row.names = TRUE, digits = 2,caption = "Brecha total de salario percibido por año") %>% kable_styling()
# Tabla 2
table2<- rbind(psych::describe(salarios99$gap_just),
psych::describe(salarios09$gap_just),
psych::describe(salarios19$gap_just))
rownames(table2) <- c("1999","2009","2019")
table2 <- table2 %>% select(n,mean,sd,median,trimmed,min,max)
kable(table2,row.names = TRUE, digits = 2,caption = "Tabla: Brecha total de salario justo por año") %>% kable_styling()
# # Tabla 3 ****************************************************************************************
#
# table3<- rbind(psych::describe(sal99$gap_just),
#                psych::describe(sal09$gap_just),
#                psych::describe(sal19$gap_just))
#
# rownames(table3) <- c("1999","2009","2019")
# table3 <- table3 %>% select(n,mean,sd,median,trimmed,min,max)
#
# kable(table3,row.names = TRUE, digits = 2,caption = "Tabla: Brecha total de salario justo por año") %>% kable_styling() %>%
# footnote(general = "Calculo realizado sin casos extremos superiores e inferiores \n Media recortada sin el 5% de cada extremo")
# # Tabla 4 ****************************************************************************************
#
# table4<- rbind(psych::describe(sal99$gap_perc),
#                psych::describe(sal09$gap_perc),
#                psych::describe(sal19$gap_perc))
#
# rownames(table4) <- c("1999","2009","2019")
# table4 <- table4 %>% select(n,mean,sd,median,trimmed,min,max)
#
# kable(table4,row.names = TRUE, digits = 2,caption = "Tabla: Brecha total de salario percibido por año") %>% kable_styling() %>%
# footnote(general = "Calculo realizado sin casos extremos superiores e inferiores \n Media recortada sin el 5% de cada extremo")
# ```
## Brecha estimada (log)
```{r Tablas descriptivos ln(gaps)}
knitr::opts_chunk$set(warning = FALSE,message = FALSE, cache = TRUE)
options(scipen=999)
rm(list=ls())
{
library(dplyr)
library(sjlabelled)
library(sjPlot)
library(ggplot2)
library(knitr)
library(kableExtra)
library(GPArotation)
library(lavaan)
library(Cairo);options(shiny.usecairo=TRUE) # Para la calidad de los plots
}
load(file = "data/dataproc/cl09.RData")
load(file = "data/dataproc/cl99.RData")
load(file = "data/dataproc/cl19.RData")
salarios99 <- cl99 %>% select(v3,
v21,v16,    # Salario percibio obrero y gerente
v31,v26)# Salario justo    obrero y gerente
dim(salarios99)
summary(salarios99)
# M2_P2_PRESIDENTE cuanto gana GERENTE
# M2_P2_OBRERO cuanto gana OBRERO
# M2_P3_PRESIDENTE cuanto deberia ganar GERENTE
# M2_P3_OBRERO cuanto deberia ganar OBRERO
# table(salarios99$v21) #  99999999999
# table(salarios99$V16) #  99999999998 99999999999
# table(salarios99$V31) # 99999999998 99999999999
# table(salarios99$V26) # 99999999998 99999999999
names(salarios99)
salarios99[2:4][salarios99[2:4] >= 99999999998] <- NA
salarios99$v3 <- as_character(salarios99$v3)
summary(salarios99)
dim(na.omit(salarios99))
colSums(is.na(salarios99))
salarios99 <- rename(salarios99,pais=v3,salperger=v16,salperobr=v21,saljusger=v26,saljusobr=v31)
table(salarios99$salperobr) # <22000000 120000000
salarios99 %>% filter(salperobr <= 40000| salperobr >= 1000000) # 13 casos
table(salarios99$salperger)
salarios99 %>% filter(salperger <= 250000 | salperger >= 100000001) # 12 casos
table(salarios99$saljusobr) # <30000000
salarios99 %>% filter(saljusobr <= 40000) # 1 caso
table(salarios99$saljusger)
salarios99 %>% filter(saljusger <= 100000) # 5 casos
# Quitar outliers *************************
dim(na.omit(salarios99))
salarios99 <- salarios99 %>%
mutate(salperobr=replace(salperobr, salperobr <= 40000 | salperobr>= 1000000, NA)) %>%
mutate(salperger=replace(salperger, salperger <= 250000 | salperger>= 100000001, NA)) %>%
mutate(saljusobr=replace(saljusobr, saljusobr <= 40000, NA)) %>%
mutate(saljusger=replace(saljusger, saljusger <= 100000, NA))
#---Brecha salarial percibida
salarios99$gap_perc   <-  as.numeric(salarios99$salperger/salarios99$salperobr) # diferencia total
salarios99$lngap_perc <-  as.numeric(log(salarios99$gap_perc))                 # diferencia log
#---Brecha salarial justa
salarios99$gap_just   <-  as.numeric(salarios99$saljusger/salarios99$saljusobr) # diferencia total
salarios99$lngap_just <-  as.numeric(log(salarios99$gap_just))                # diferencia log
# table(salarios09$V23) # cuanto gana GERENTE
# table(salarios09$V25) # cuanto gana OBRERO
# table(salarios09$V28) # cuando deberia ganar GERENTE
# table(salarios09$V30) # cuanto deberia ganar OBRERO
salarios09 <- cl09 %>% select(v5,
v23,v25, # Salario percibido obrero y gerente
v28,v30) # Salario justo    obrero y gerente
summary(salarios09)
salarios09$v5 <- as_character(salarios09$v5)
#--- Nombres sustantivos para analisis
salarios09 <- rename(salarios09,pais=v5,salperger=v23,salperobr=v25,saljusger=v28,saljusobr=v30)
salarios09 <- salarios09 %>%
mutate(salperobr=replace(salperobr, salperobr <= 40000 | salperobr>= 1000000, NA)) %>%
mutate(salperger=replace(salperger, salperger <= 250000 | salperger>= 100000001, NA)) %>%
mutate(saljusobr=replace(saljusobr, saljusobr <= 40000, NA)) %>%
mutate(saljusger=replace(saljusger, saljusger <= 100000, NA))
summary(salarios09)
dim(na.omit(salarios09))
#---Brecha salarial percibida
salarios09$gap_perc   <-  as.numeric(salarios09$salperger/salarios09$salperobr) # diferencia total
salarios09$lngap_perc <-  as.numeric(log(salarios09$gap_perc))                # diferencia log
#---Brecha salarial justa
salarios09$gap_just   <-  as.numeric(salarios09$saljusger/salarios09$saljusobr) # diferencia total
salarios09$lngap_just <-  as.numeric(log(salarios09$gap_just))                # diferencia log
salarios19 <- cl19 %>% select(m2_p2_presidente,m2_p2_obrero,  # Salario percibio obrero y gerente
m2_p3_presidente,m2_p3_obrero) # Salario justo    obrero y gerente
summary(salarios19)
# NAs already identified
#--- Nombres sustantivos para analisis
salarios19 <- rename(salarios19,salperger=m2_p2_presidente,salperobr=m2_p2_obrero,
saljusger=m2_p3_presidente,saljusobr=m2_p3_obrero)
salarios19 <- salarios19 %>%
mutate(salperobr=replace(salperobr, salperobr <= 40000 | salperobr>= 1000000, NA)) %>%
mutate(salperger=replace(salperger, salperger <= 250000 | salperger>= 100000001, NA)) %>%
mutate(saljusobr=replace(saljusobr, saljusobr <= 40000, NA)) %>%
mutate(saljusger=replace(saljusger, saljusger <= 100000, NA))
summary(salarios19)
#---Brecha salarial percibida
salarios19$gap_perc   <-  as.numeric(salarios19$salperger/salarios19$salperobr) # diferencia total
salarios19$lngap_perc <-  as.numeric(log(salarios19$gap_perc))                  # diferencia log
#---Brecha salarial justa
salarios19$gap_just   <-  as.numeric(salarios19$saljusger/salarios19$saljusobr) # diferencia total
salarios19$lngap_just <-  as.numeric(log(salarios19$gap_just))                # diferencia log
table_perob<- rbind(psych::describe(salarios99$salperobr),
psych::describe(salarios09$salperobr),
psych::describe(salarios19$salperobr))
rownames(table_perob) <- c("1999","2009","2019")
table_perob <- table_perob %>% select(n,mean,sd,median,trimmed,min,max)
table_perob
table_perger<- rbind(psych::describe(salarios99$salperger),
psych::describe(salarios09$salperger),
psych::describe(salarios19$salperger))
rownames(table_perger) <- c("1999","2009","2019")
table_perger <- table_perger %>% select(n,mean,sd,median,trimmed,min,max)
table_perger
# Add occupation & year to tables
table_perob$ocup <-  1 # as.factor(c("Obrero"))
table_perob$year <- c(1999,2009,2019)
table_perger$ocup <- 2 # as.factor(c("Gerente"))
table_perger$year <- c(1999,2009,2019)
table_pertot <-rbind(table_perger,table_perob)
str(table_pertot)
table_pertot
bar <- ggplot(table_pertot, aes(as.factor(year),median)) +
geom_bar(aes(fill = factor(ocup, levels=c(1,2), labels=c("Obrero", "Gerente"))), position = "dodge", stat="identity", width=.5)  +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), group="Ocup"), position=position_dodge(width=0.5), vjust=-0.5) +
theme_bw(base_size = 18) +
scale_y_continuous(labels = scales::comma) +
ylab('Salario (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") # quitar nombre leyenda, autoexplicativo +
bar
# Horizontal
table_pertot$ocup2 <- factor(table_pertot$ocup, levels=c(2,1), labels=c("Gerente", "Obrero"))
ggplot(data=table_pertot, aes(x=reorder(as.factor(year),-median), y=median, fill=ocup2)) +
geom_bar(position = 'dodge', stat='identity') +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), y=0), position=position_dodge(0.9), hjust=-0.25) +
theme_bw(base_size = 12) +
scale_y_continuous(labels = scales::comma) +
ylab('Salario percibido (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") +
coord_flip()
# Tabla 1
table1<- rbind(psych::describe(salarios99$gap_perc),
psych::describe(salarios09$gap_perc),
psych::describe(salarios19$gap_perc))
rownames(table1) <- c("1999","2009","2019")
table1 <- table1 %>% select(n,mean,sd,median,trimmed,min,max)
kable(table1,row.names = TRUE, digits = 2,caption = "Brecha total de salario percibido por año") %>% kable_styling()
# Tabla 2
table2<- rbind(psych::describe(salarios99$gap_just),
psych::describe(salarios09$gap_just),
psych::describe(salarios19$gap_just))
rownames(table2) <- c("1999","2009","2019")
table2 <- table2 %>% select(n,mean,sd,median,trimmed,min,max)
kable(table2,row.names = TRUE, digits = 2,caption = "Tabla: Brecha total de salario justo por año") %>% kable_styling()
# # Tabla 3 ****************************************************************************************
#
# table3<- rbind(psych::describe(sal99$gap_just),
#                psych::describe(sal09$gap_just),
#                psych::describe(sal19$gap_just))
#
# rownames(table3) <- c("1999","2009","2019")
# table3 <- table3 %>% select(n,mean,sd,median,trimmed,min,max)
#
# kable(table3,row.names = TRUE, digits = 2,caption = "Tabla: Brecha total de salario justo por año") %>% kable_styling() %>%
# footnote(general = "Calculo realizado sin casos extremos superiores e inferiores \n Media recortada sin el 5% de cada extremo")
# # Tabla 4 ****************************************************************************************
#
# table4<- rbind(psych::describe(sal99$gap_perc),
#                psych::describe(sal09$gap_perc),
#                psych::describe(sal19$gap_perc))
#
# rownames(table4) <- c("1999","2009","2019")
# table4 <- table4 %>% select(n,mean,sd,median,trimmed,min,max)
#
# kable(table4,row.names = TRUE, digits = 2,caption = "Tabla: Brecha total de salario percibido por año") %>% kable_styling() %>%
# footnote(general = "Calculo realizado sin casos extremos superiores e inferiores \n Media recortada sin el 5% de cada extremo")
# ```
## Brecha estimada (log)
# Tabla 1 ****************************************************************************************
table1b<- rbind(psych::describe(log(salarios99$gap_perc)),
psych::describe(log(salarios09$gap_perc)),
psych::describe(log(salarios19$gap_perc)))
rownames(table1b) <- c("1999","2009","2019")
table1b <- table1b %>% select(n,mean,sd,median,trimmed,min,max)
kable(table1b,row.names = TRUE, digits = 2,caption = "Brecha total de ln(salario percibido) por año") %>% kable_styling()
# Tabla 2 ****************************************************************************************
table2b<- rbind(psych::describe(log(salarios99$gap_just)),
psych::describe(log(salarios09$gap_just)),
psych::describe(log(salarios19$gap_just)))
rownames(table2b) <- c("1999","2009","2019")
table2b <- table2b %>% select(n,mean,sd,median,trimmed,min,max)
kable(table2b,row.names = TRUE, digits = 2,caption = "Tabla: Brecha total de ln(salario justo) por año") %>% kable_styling()
# Tabla 3 ****************************************************************************************
table3b<- rbind(psych::describe(log(sal99$gap_just)),
psych::describe(log(sal09$gap_just)),
psych::describe(log(sal19$gap_just)))
View(table_perger)
View(table_pertot)
View(salarios09)
table_jusob<- rbind(psych::describe(salarios99$saljusobr),
psych::describe(salarios09$saljusobr),
psych::describe(salarios19$saljusobr))
rownames(table_jusob) <- c("1999","2009","2019")
table_jusob <- table_jusob %>% select(n,mean,sd,median,trimmed,min,max)
table_jusob
table_jusob<- rbind(psych::describe(salarios99$saljusobr),
psych::describe(salarios09$saljusobr),
psych::describe(salarios19$saljusobr))
rownames(table_jusob) <- c("1999","2009","2019")
table_jusob <- table_jusob %>% select(n,mean,sd,median,trimmed,min,max)
table_jusob
table_jusger<- rbind(psych::describe(salarios99$saljusger),
psych::describe(salarios09$saljusger),
psych::describe(salarios19$saljusger))
rownames(table_jusger) <- c("1999","2009","2019")
table_jusger <- table_perger %>% select(n,mean,sd,median,trimmed,min,max)
table_jusger
table_jusger<- rbind(psych::describe(salarios99$saljusger),
psych::describe(salarios09$saljusger),
psych::describe(salarios19$saljusger))
rownames(table_jusger) <- c("1999","2009","2019")
table_jusger <- table_jusger %>% select(n,mean,sd,median,trimmed,min,max)
table_jusger
# Add occupation & year to tables
table_jusob$ocup <-  1 # as.factor(c("Obrero"))
table_jusob$year <- c(1999,2009,2019)
table_jusger$ocup <- 2 # as.factor(c("Gerente"))
table_jusger$year <- c(1999,2009,2019)
table_justot <-rbind(table_jusger,table_jusob)
str(table_justot)
table_justot
bar <- ggplot(table_justot, aes(as.factor(year),median)) +
geom_bar(aes(fill = factor(ocup, levels=c(1,2), labels=c("Obrero", "Gerente"))), position = "dodge", stat="identity", width=.5)  +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), group="Ocup"), position=position_dodge(width=0.5), vjust=-0.5) +
theme_bw(base_size = 18) +
scale_y_continuous(labels = scales::comma) +
ylab('Salario (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") # quitar nombre leyenda, autoexplicativo +
bar
# Horizontal
table_justot$ocup2 <- factor(table_justot$ocup, levels=c(2,1), labels=c("Gerente", "Obrero"))
ggplot(data=table_justot, aes(x=reorder(as.factor(year),-median), y=median, fill=ocup2)) +
geom_bar(position = 'dodge', stat='identity') +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), y=0), position=position_dodge(0.9), hjust=-0.25) +
theme_bw(base_size = 12) +
scale_y_continuous(labels = scales::comma) +
ylab('Salario justo (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") +
coord_flip()
table_gap_perc<- rbind(psych::describe(salarios99$gap_perc),
psych::describe(salarios09$gap_perc),
psych::describe(salarios19$gap_perc))
rownames(table_jusob) <- c("1999","2009","2019")
table_gap_perc <- table_gap_perc %>% select(n,mean,sd,median,trimmed,min,max)
table_jusob
table_gap_just<- rbind(psych::describe(salarios99$gap_just),
psych::describe(salarios09$gap_just),
psych::describe(salarios19$gap_just))
rownames(gap_just) <- c("1999","2009","2019")
table_gap_perc<- rbind(psych::describe(salarios99$gap_perc),
psych::describe(salarios09$gap_perc),
psych::describe(salarios19$gap_perc))
rownames(table_gap_perc) <- c("1999","2009","2019")
table_gap_perc <- table_gap_perc %>% select(n,mean,sd,median,trimmed,min,max)
table_gap_perc
table_gap_just<- rbind(psych::describe(salarios99$gap_just),
psych::describe(salarios09$gap_just),
psych::describe(salarios19$gap_just))
rownames(table_gap_just) <- c("1999","2009","2019")
table_gap_just <- table_gap_just %>% select(n,mean,sd,median,trimmed,min,max)
table_gap_just
# Add occupation & year to tables
table_gap_perc$ocup <-  1 # as.factor(c("Obrero"))
table_gap_perc$year <- c(1999,2009,2019)
table_gap_just$ocup <- 2 # as.factor(c("Gerente"))
table_gap_just$year <- c(1999,2009,2019)
table_gap_total <-rbind(table_gap_perc,table_gap_just)
str(table_gap_total)
table_gap_total
bar3 <- ggplot(table_gap_total, aes(as.factor(year),median)) +
geom_bar(aes(fill = factor(ocup, levels=c(1,2), labels=c("percepcion", "justicia"))), position = "dodge", stat="identity", width=.5)  +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), group="Ocup"), position=position_dodge(width=0.5), vjust=-0.5) +
theme_bw(base_size = 18) +
scale_y_continuous(labels = scales::comma) +
ylab('Brecha (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") # quitar nombre leyenda, autoexplicativo +
bar3
# Horizontal
table_gap_total$ocup2 <- factor(table_gap_total$ocup, levels=c(2,1), labels=c("percepcion", "justa"))
ggplot(data=table_gap_total, aes(x=reorder(as.factor(year),-median), y=median, fill=ocup2)) +
geom_bar(position = 'dodge', stat='identity') +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), y=0), position=position_dodge(0.9), hjust=-0.25) +
theme_bw(base_size = 12) +
scale_y_continuous(labels = scales::comma) +
ylab('brecha (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") +
coord_flip()
# Add occupation & year to tables
table_gap_perc$ocup <-  1 # as.factor(c("Obrero"))
table_gap_perc$year <- c(1999,2009,2019)
table_gap_just$ocup <- 2 # as.factor(c("Gerente"))
table_gap_just$year <- c(1999,2009,2019)
table_gap_total <-rbind(table_gap_perc,table_gap_just)
str(table_gap_total)
table_gap_total
bar3 <- ggplot(table_gap_total, aes(as.factor(year),median)) +
geom_bar(aes(fill = factor(ocup, levels=c(1,2), labels=c("percepcion", "justicia"))), position = "dodge", stat="identity", width=.5)  +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), group="Ocup"), position=position_dodge(width=0.5), vjust=-0.5) +
theme_bw(base_size = 18) +
scale_y_continuous(labels = scales::comma) +
ylab('Brecha (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") # quitar nombre leyenda, autoexplicativo +
bar3
# Horizontal
table_gap_total$ocup2 <- factor(table_gap_total$ocup, levels=c(2,1), labels=c("justa", "percibida"))
ggplot(data=table_gap_total, aes(x=reorder(as.factor(year),-median), y=median, fill=ocup2)) +
geom_bar(position = 'dodge', stat='identity') +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), y=0), position=position_dodge(0.9), hjust=-0.25) +
theme_bw(base_size = 12) +
scale_y_continuous(labels = scales::comma) +
ylab('brecha (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") +
coord_flip()
ggplot?
ggplot(data=table_justot, aes(x=reorder(as.factor(year),-median), y=median, fill=ocup2)) +
geom_bar(position = 'dodge', stat='identity') +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), y=0), position=position_dodge(0.9), hjust=-0.25) +
theme_bw(base_size = 12) +
scale_y_continuous(labels = scales::comma) +
ylab('Salario justo (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="") +
labs(fill = " ") +
coord_flip()
ggplot(data=table_justot, aes(x=reorder(as.factor(year),-median), y=median, fill=ocup2)) +
geom_bar(position = 'dodge', stat='identity') +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), y=0), position=position_dodge(0.9), hjust=-0.25) +
theme_bw(base_size = 12) +
scale_y_continuous(labels = scales::comma) +
ylab('Salario justo (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") +
coord_flip()
# Add occupation & year to tables
table_jusob$ocup <-  1 # as.factor(c("Obrero"))
table_jusob$year <- c(1999,2009,2019)
table_jusger$ocup <- 2 # as.factor(c("Gerente"))
table_jusger$year <- c(1999,2009,2019)
table_justot <-rbind(table_jusger,table_jusob)
str(table_justot)
table_justot
bar2 <- ggplot(table_justot, aes(as.factor(year),median)) +
geom_bar(aes(fill = factor(ocup, levels=c(1,2), labels=c("Obrero", "Gerente"))), position = "dodge", stat="identity", width=.5)  +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), group="Ocup"), position=position_dodge(width=0.5), vjust=-0.5) +
theme_bw(base_size = 18) +
scale_y_continuous(labels = scales::comma) +
ylab('Salario (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") # quitar nombre leyenda, autoexplicativo +
bar2
# Horizontal
table_justot$ocup2 <- factor(table_justot$ocup, levels=c(2,1), labels=c("Gerente", "Obrero"))
ggplot(data=table_justot, aes(x=reorder(as.factor(year),-median), y=median, fill=ocup2)) +
geom_bar(position = 'dodge', stat='identity') +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), y=0), position=position_dodge(0.9), hjust=-0.25) +
theme_bw(base_size = 12) +
scale_y_continuous(labels = scales::comma) +
ylab('Salario justo (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") +
coord_flip()
ggplot?
# Add occupation & year to tables
table_jusob$ocup <-  1 # as.factor(c("Obrero"))
table_jusob$year <- c(1999,2009,2019)
table_jusger$ocup <- 2 # as.factor(c("Gerente"))
table_jusger$year <- c(1999,2009,2019)
table_justot <-rbind(table_jusger,table_jusob)
str(table_justot)
table_justot
bar2 <- ggplot(table_justot, aes(as.factor(year),median)) +
geom_bar(aes(fill = factor(ocup, levels=c(1,2), labels=c("Obrero", "Gerente"))), position = "dodge", stat="identity", width=.5)  +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), group="Ocup"), position=position_dodge(width=0.5), vjust=-0.5) +
theme_bw(base_size = 18) +
scale_y_continuous(labels = scales::comma) +
ylab('Salario (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") # quitar nombre leyenda, autoexplicativo +
bar2
# Horizontal
table_justot$ocup2 <- factor(table_justot$ocup, levels=c(2,1), labels=c("Gerente", "Obrero"))
ggplot(data=table_justot, aes(x=reorder(as.factor(year),-median), y=median, fill=ocup2)) +
geom_bar(position = 'dodge', stat='identity') +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), y=0), position=position_dodge(0.9), hjust=-0.25) +
theme_bw(base_size = 12) +
scale_y_continuous(labels = scales::comma) +
ylab('Salario justo (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") +
coord_flip()
# Add occupation & year to tables
table_gap_perc$ocup <-  1 # as.factor(c("Obrero"))
table_gap_perc$year <- c(1999,2009,2019)
table_gap_just$ocup <- 2 # as.factor(c("Gerente"))
table_gap_just$year <- c(1999,2009,2019)
table_gap_total <-rbind(table_gap_perc,table_gap_just)
str(table_gap_total)
table_gap_total
bar3 <- ggplot(table_gap_total, aes(as.factor(year),median)) +
geom_bar(aes(fill = factor(ocup, levels=c(1,2), labels=c("justa ", "percibida"))), position = "dodge", stat="identity", width=.5)  +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), group="Ocup"), position=position_dodge(width=0.5), vjust=-0.5) +
theme_bw(base_size = 18) +
scale_y_continuous(labels = scales::comma) +
ylab('Brecha (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") # quitar nombre leyenda, autoexplicativo +
bar3
# Horizontal
table_gap_total$ocup2 <- factor(table_gap_total$ocup, levels=c(2,1), labels=c("justa", "percibida"))
ggplot(data=table_gap_total, aes(x=reorder(as.factor(year),-median), y=median, fill=ocup2)) +
geom_bar(position = 'dodge', stat='identity') +
geom_text(aes(label=format(median, big.mark = ",", scientific = FALSE), y=0), position=position_dodge(0.9), hjust=-0.25) +
theme_bw(base_size = 12) +
scale_y_continuous(labels = scales::comma) +
ylab('Brecha (mediana)') + xlab('Años') +
scale_fill_brewer(palette="Paired") +
theme(legend.position="top") +
labs(fill = " ") +
coord_flip()
